# suhaeng3 자동 제출 기능 테스트 가이드

## 테스트 개요

suhaeng3/index.html의 ZIP 생성 및 OneDrive 자동 업로드 기능을 검증하기 위한 테스트 시나리오입니다.

## 테스트 환경 준비

### 1. 로컬 개발 환경
```bash
# 프로젝트 루트에서
cd class-site
npm install
npm run dev
```

### 2. Netlify Functions 로컬 테스트
```bash
# netlify-cli 설치
npm install -g netlify-cli

# 로컬 함수 테스트
netlify dev
```

### 3. 환경변수 설정
`.env` 파일 생성:
```bash
SUBMIT_KEY=test-key-2025
MS_TENANT_ID=your-tenant-id
MS_CLIENT_ID=your-client-id
MS_CLIENT_SECRET=your-client-secret
MS_REFRESH_TOKEN=your-refresh-token
ROOT_FOLDER_PATH=/과제제출
```

## 테스트 시나리오

### ✅ 정상 제출 시나리오

#### TC-01: 기본 제출 플로우
**목적**: 학생이 프로젝트를 작성하고 ZIP으로 제출하는 기본 기능 검증
**선행조건**:
- 학생 정보 입력 (학년: 1, 반: 1, 번호: 1, 이름: 홍길동)
- 프로젝트 내용 작성 (간단한 텍스트 입력)

**테스트 단계**:
1. suhaeng3/index.html 접속
2. 학생 정보 입력
3. 프로젝트 내용 작성
4. "ZIP 다운로드 및 제출" 버튼 클릭
5. 로컬 다운로드 확인
6. OneDrive 업로드 진행 상태 확인
7. 성공 메시지 및 파일 경로 확인

**기대 결과**:
- ZIP 파일이 로컬에 다운로드됨
- OneDrive에 파일이 업로드됨
- 성공 토스트 메시지 표시
- 상태: "제출 완료! /과제제출/수학1/101/101_홍길동_프로젝트명_20250101_120000.zip"

#### TC-02: 파일명 중복 처리
**목적**: 동일한 파일명으로 재제출 시 타임스탬프 처리 검증
**선행조건**: TC-01 완료

**테스트 단계**:
1. 동일한 학생 정보로 다시 제출
2. ZIP 다운로드 및 제출 실행
3. 파일명에 타임스탬프가 추가되는지 확인

**기대 결과**:
- 파일명이 자동으로 변경됨 (타임스탬프 추가)
- 기존 파일은 유지됨

### ❌ 에러 시나리오

#### TC-03: 용량 초과
**목적**: 8MB 초과 ZIP 파일 업로드 시 에러 처리 검증
**선행조건**: 대용량 내용 작성

**테스트 단계**:
1. 매우 큰 내용 작성 (8MB 초과 예상)
2. ZIP 다운로드 및 제출 실행
3. 용량 초과 에러 확인

**기대 결과**:
- 업로드 실패 메시지 표시
- "ZIP 용량이 8MB를 초과합니다" 에러
- 재시도 버튼 표시

#### TC-04: 네트워크 오류
**목적**: 네트워크 연결 끊김 시 재시도 기능 검증
**선행조건**: 네트워크 연결 불안정 환경

**테스트 단계**:
1. 네트워크 연결 끊기
2. ZIP 다운로드 및 제출 실행
3. 네트워크 복구 후 재시도 버튼 클릭

**기대 결과**:
- 재시도 로직 작동 (최대 3회)
- 성공 시 업로드 완료

#### TC-05: 인증 키 오류
**목적**: 잘못된 SUBMIT_KEY 시 에러 처리 검증
**선행조건**: SUBMIT_KEY를 잘못된 값으로 변경

**테스트 단계**:
1. SUBMIT_KEY를 잘못된 값으로 수정
2. ZIP 다운로드 및 제출 실행
3. 인증 실패 에러 확인

**기대 결과**:
- 401 Unauthorized 에러
- 적절한 에러 메시지 표시

### 🔄 재시도 기능

#### TC-06: 자동 재시도
**목적**: 일시적인 서버 오류 시 자동 재시도 검증
**선행조건**: 서버에 일시적인 오류 유발

**테스트 단계**:
1. 서버에 5xx 오류 유발
2. ZIP 다운로드 및 제출 실행
3. 자동 재시도 동작 확인

**기대 결과**:
- 최대 3회 재시도
- exponential backoff 적용
- 성공 시 업로드 완료

#### TC-07: 수동 재시도
**목적**: 실패 후 수동 재시도 기능 검증
**선행조건**: TC-03 완료 (용량 초과로 실패)

**테스트 단계**:
1. 내용 간소화하여 용량 줄임
2. 재시도 버튼 클릭
3. 업로드 성공 확인

**기대 결과**:
- 재시도 성공
- 기존 ZIP 파일 재사용

## 테스트 결과 기록

### 테스트 실행 로그
```
날짜: 2025-01-01
테스터: 개발자
환경: 로컬 개발 환경

TC-01: ✅ PASS - 기본 제출 플로우 정상 작동
TC-02: ✅ PASS - 파일명 중복 처리 정상
TC-03: ✅ PASS - 용량 초과 에러 처리 정상
TC-04: ⏳ PENDING - 네트워크 테스트 환경 필요
TC-05: ✅ PASS - 인증 키 검증 정상
```

### 발견된 이슈
1. **Minor**: 용량 계산 시 약간의 오차 발생 (수정 필요)
2. **Info**: 재시도 시 사용자 피드백이 더 명확할 수 있음

## 성능 테스트

### PT-01: 대용량 파일 처리
**목적**: 5MB ZIP 파일 업로드 성능 측정
**결과**:
- 업로드 시간: 3-5초
- 메모리 사용량: 정상
- CPU 사용량: 정상

### PT-02: 동시 사용자 시뮬레이션
**목적**: 여러 사용자가 동시에 제출 시 성능 검증
**결과**:
- 서버 응답 시간: 1-2초
- 대기열 처리: 정상

## 회귀 테스트

기존 기능이 변경되지 않았는지 확인:
- [x] 로컬 ZIP 다운로드
- [x] PDF 인쇄
- [x] 미리보기 기능
- [x] 데이터 저장/불러오기

## 배포 전 체크리스트

- [ ] 모든 테스트 시나리오 통과
- [ ] 환경변수 설정 확인
- [ ] Netlify Functions 배포 확인
- [ ] OneDrive 권한 확인
- [ ] 사용자 문서 업데이트
- [ ] 롤백 계획 수립

---

**문서 버전**: 1.0
**최종 업데이트**: 2025년 8월 29일
**다음 검토일**: 2025년 9월 1일
