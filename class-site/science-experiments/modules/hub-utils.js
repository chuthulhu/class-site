// hub-utils.js - 공용 헬퍼
export function escapeHtml(s=''){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;'); }
export function debounce(fn, delay=300){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), delay); }; }
export function blobToBase64(blob){ return new Promise((res,rej)=>{ const r=new FileReader(); r.onload=()=>{ const result=r.result||''; const idx=String(result).indexOf(','); res(idx>=0?String(result).slice(idx+1):String(result)); }; r.onerror=()=>rej(r.error); r.readAsDataURL(blob); }); }
export function bytesFromBase64(b64){ const len=b64.length; const pad=b64.endsWith('==')?2:(b64.endsWith('=')?1:0); return Math.floor((len*3)/4)-pad; }
export function detectInApp(){ const raw=navigator.userAgent||navigator.vendor||''; const ua=raw.toLowerCase(); const isIOS=/iphone|ipad|ipod/.test(ua)||(navigator.platform==='MacIntel'&&navigator.maxTouchPoints>1); const isAndroid=/android/.test(ua); const isSamsung=/samsungbrowser/i.test(raw); const isKakao=/kakaotalk/.test(ua); const isNaver=/naver/.test(ua); const isFB=/fban|fbav|fb_iab/.test(ua); const isIG=/instagram/.test(ua); const isLine=/ line\//.test(ua); const isIOSWebView=isIOS && !!window.webkit && !!window.webkit.messageHandlers && !/safari/i.test(raw); const isInApp=isKakao||isNaver||isFB||isIG||isLine||isIOSWebView; let app=null; if(isKakao) app='kakao'; else if(isNaver) app='naver'; else if(isIG) app='instagram'; else if(isFB) app='facebook'; else if(isLine) app='line'; else if(isIOSWebView) app='ios-webview'; return { isInApp, app, isIOS, isAndroid, isSamsung }; }
export function isIOS(){ const ua=navigator.userAgent||navigator.vendor||''; const iOSDevice=/iPad|iPhone|iPod/.test(ua); const iPadOSDesktopUA=navigator.platform==='MacIntel'&&navigator.maxTouchPoints>1; return iOSDevice||iPadOSDesktopUA; }
