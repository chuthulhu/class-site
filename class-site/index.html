<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµì‚¬ ê´€ë¦¬ í¬í„¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- ë¡œì»¬ ê°œë°œ ì„¤ì • (ë¡œì»¬ í™˜ê²½ì—ì„œë§Œ ë¡œë“œ) -->
    <script>
        // ë¡œì»¬ ê°œë°œ í™˜ê²½ ê°ì§€
        const isLocalDev = window.location.hostname === 'localhost' || 
                          window.location.hostname === '127.0.0.1' ||
                          window.location.hostname.includes('192.168') ||
                          window.location.protocol === 'file:';
        
        if (isLocalDev) {
            // ë¡œì»¬ ê°œë°œìš© ì„¤ì • ë¡œë“œ (ë°°í¬ í™˜ê²½ì—ì„œëŠ” íŒŒì¼ì´ ì—†ì„ ìˆ˜ ìˆìŒ)
            const script = document.createElement('script');
            script.src = 'local-dev-config.js';
            script.onerror = function() {
                console.warn('ë¡œì»¬ ê°œë°œ ì„¤ì • íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ ì„¤ì •ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.');
                window.LOCAL_DEV_CONFIG = {
                    ADMIN_PASSWORD: 'teacher2024',
                    ENABLE_LOCAL_AUTH: true,
                    DEBUG_MODE: true
                };
            };
            script.onload = function() {
                console.log('ë¡œì»¬ ê°œë°œ ì„¤ì • íŒŒì¼ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
            };
            document.head.appendChild(script);
        } else {
            // í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ë¡œì»¬ ì„¤ì •ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
            console.log('í”„ë¡œë•ì…˜ í™˜ê²½: Cloudflare Pages Functions ì‚¬ìš©');
        }
    </script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- ë¡œê·¸ì¸ í™”ë©´ -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100">
        <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md">
            <div class="text-center mb-6">
                <div class="text-4xl mb-4">ğŸ”</div>
                <h1 class="text-2xl font-bold text-gray-800">êµì‚¬ ê´€ë¦¬ í¬í„¸</h1>
                <p class="text-gray-600 mt-2">ê´€ë¦¬ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤</p>
                <div id="local-dev-notice" class="mt-3 p-2 bg-blue-50 border border-blue-200 rounded-lg text-sm text-blue-700 hidden">
                    <strong>ë¡œì»¬ ê°œë°œ ëª¨ë“œ:</strong> <code class="bg-blue-100 px-1 rounded">local-dev-config.js</code> íŒŒì¼ì—ì„œ ì•”í˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”
                </div>
            </div>
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-2">ê´€ë¦¬ì ì•”í˜¸</label>
                    <input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ì•”í˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" autocomplete="current-password" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    ë¡œê·¸ì¸
                </button>
            </form>
            <div id="error-message" class="mt-4 text-red-600 text-sm text-center hidden"></div>
            
            <!-- ë””ë²„ê¹… ì •ë³´ (ê°œë°œìš©) -->
            <div id="debug-info" class="mt-4 text-xs text-gray-400 text-center hidden">
                <div>í™˜ê²½ë³€ìˆ˜ ìƒíƒœ: <span id="env-status">í™•ì¸ ì¤‘...</span></div>
                <div>API ì—”ë“œí¬ì¸íŠ¸: /api/auth</div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ í¬í„¸ í™”ë©´ -->
    <div id="main-portal" class="hidden">
        <div class="max-w-6xl mx-auto p-4 sm:p-6">
            <!-- í—¤ë” -->
            <header class="bg-white rounded-xl shadow-md p-6 mb-8">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">êµì‚¬ ê´€ë¦¬ í¬í„¸</h1>
                        <p class="text-gray-600 mt-1">ê³¼ì œ ì œì¶œ í˜„í™© ë° í•™ìƒ ê´€ë¦¬</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-sm text-gray-500">
                            <span id="current-time"></span>
                        </div>
                        <button id="logout-btn" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-sm">
                            ë¡œê·¸ì•„ì›ƒ
                        </button>
                    </div>
                </div>
            </header>

            <!-- êµê³¼ë³„ í™œë™ í˜„í™© -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="flex items-center">
                        <div class="p-3 bg-indigo-100 rounded-lg">
                            <span class="text-2xl">âš›ï¸</span>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">ë¬¼ë¦¬í•™II</p>
                            <p class="text-lg font-bold text-gray-800">í™œë™ 1ê°œ</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="flex items-center">
                        <div class="p-3 bg-green-100 rounded-lg">
                            <span class="text-2xl">ğŸ”¬</span>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">ê³¼í•™íƒêµ¬ì‹¤í—˜</p>
                            <p class="text-lg font-bold text-gray-800">í™œë™ ë‹¤ìˆ˜</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="flex items-center">
                        <div class="p-3 bg-purple-100 rounded-lg">
                            <span class="text-2xl">ğŸ“š</span>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">ì „ì²´ êµê³¼</p>
                            <p class="text-lg font-bold text-gray-800">2ê°œ êµê³¼</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- êµê³¼ë³„ ê´€ë¦¬ -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- ë¬¼ë¦¬í•™II ê´€ë¦¬ -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white">
                        <div class="flex items-center">
                            <span class="text-3xl mr-3">âš›ï¸</span>
                            <div>
                                <h3 class="text-xl font-bold">ë¬¼ë¦¬í•™II</h3>
                                <p class="text-indigo-100 text-sm">2í•™ê¸° ìˆ˜í–‰í‰ê°€ í™œë™</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4">
                            <a href="physics2/activity2/" class="block w-full bg-indigo-50 hover:bg-indigo-100 text-indigo-700 font-medium py-3 px-4 rounded-lg transition-colors text-center">
                                ğŸ“° ìµœì‹  ë¬¼ë¦¬í•™, ê³µí•™ ì—°ê´€ê¸°ì‚¬ íƒêµ¬ ë°œí‘œ
                            </a>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-800 mb-2">í™œë™ ì •ë³´</h4>
                                <div class="text-sm text-gray-600 space-y-1">
                                    <div>â€¢ í™œë™ ìœ í˜•: ê¸°ì‚¬íƒêµ¬ ë° ë°œí‘œ</div>
                                    <div>â€¢ í‰ê°€ ìš”ì†Œ: ê³¼í•™ì  ì •ë³´ ì†Œì–‘, ìœµí•©ì  ì‚¬ê³ ë ¥</div>
                                    <div>â€¢ ì œì¶œ í˜•íƒœ: ZIP íŒŒì¼ (HTML + ë°œí‘œ ìŠ¤í¬ë¦½íŠ¸)</div>
                                    <div>â€¢ ë°œí‘œ ì‹œê°„: 5-7ë¶„</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <button onclick="previewActivity('physics2')" class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors text-sm">
                                    ğŸ‘ï¸ í™œë™ì§€ ë¯¸ë¦¬ë³´ê¸°
                                </button>
                                <button onclick="editActivity('physics2')" class="bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors text-sm">
                                    âœï¸ í™œë™ì§€ í¸ì§‘
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ê³¼í•™íƒêµ¬ì‹¤í—˜ ê´€ë¦¬ -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="bg-gradient-to-r from-green-500 to-teal-600 p-6 text-white">
                        <div class="flex items-center">
                            <span class="text-3xl mr-3">ğŸ”¬</span>
                            <div>
                                <h3 class="text-xl font-bold">ê³¼í•™íƒêµ¬ì‹¤í—˜</h3>
                                <p class="text-green-100 text-sm">ì‹¤í—˜ ë° íƒêµ¬ í™œë™</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4">
                            <a href="science-experiments/" class="block w-full bg-green-50 hover:bg-green-100 text-green-700 font-medium py-3 px-4 rounded-lg transition-colors text-center">
                                ğŸ§ª ê³¼í•™íƒêµ¬ì‹¤í—˜ êµê³¼ í™ˆ
                            </a>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-800 mb-2">í™œë™ ì •ë³´</h4>
                                <div class="text-sm text-gray-600 space-y-1">
                                    <div>â€¢ í™œë™ ìœ í˜•: ë‹¤ì–‘í•œ ê³¼í•™ ì‹¤í—˜ ë° íƒêµ¬</div>
                                    <div>â€¢ í‰ê°€ ìš”ì†Œ: ì‹¤í—˜ ì„¤ê³„, ë°ì´í„° ë¶„ì„, ê³¼í•™ì  ì‚¬ê³ </div>
                                    <div>â€¢ ì œì¶œ í˜•íƒœ: ì‹¤í—˜ ë³´ê³ ì„œ ë° ë¶„ì„ ìë£Œ</div>
                                    <div>â€¢ í™œë™ ìˆ˜: ë‹¤ìˆ˜ì˜ ì‹¤í—˜ ë° íƒêµ¬ í™œë™</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <button onclick="previewActivity('science')" class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors text-sm">
                                    ğŸ‘ï¸ í™œë™ì§€ ë¯¸ë¦¬ë³´ê¸°
                                </button>
                                <button onclick="editActivity('science')" class="bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors text-sm">
                                    âœï¸ í™œë™ì§€ í¸ì§‘
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- í™œë™ ê´€ë¦¬ ë„êµ¬ -->
            <div class="bg-white rounded-xl shadow-md p-6 mt-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-gray-800">í™œë™ ê´€ë¦¬ ë„êµ¬</h3>
                    <div class="flex space-x-2">
                        <button onclick="createNewActivity()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors text-sm">
                            â• ìƒˆ í™œë™ ì¶”ê°€
                        </button>
                        <button onclick="manageActivities()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors text-sm">
                            ğŸ“‹ í™œë™ ëª©ë¡ ê´€ë¦¬
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- í™œë™ í…œí”Œë¦¿ -->
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center mb-3">
                            <span class="text-2xl mr-2">ğŸ“</span>
                            <h4 class="font-medium text-gray-800">ê¸°ë³¸ í™œë™ì§€</h4>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">í•™ìƒ ì •ë³´ ì…ë ¥, í™œë™ ë‚´ìš© ì‘ì„±, ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ì´ í¬í•¨ëœ ê¸°ë³¸ í…œí”Œë¦¿</p>
                        <button onclick="useTemplate('basic')" class="w-full bg-gray-100 text-gray-700 py-2 px-3 rounded-lg hover:bg-gray-200 transition-colors text-sm">
                            í…œí”Œë¦¿ ì‚¬ìš©
                        </button>
                    </div>

                    <!-- ë°œí‘œ í™œë™ í…œí”Œë¦¿ -->
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center mb-3">
                            <span class="text-2xl mr-2">ğŸ¤</span>
                            <h4 class="font-medium text-gray-800">ë°œí‘œ í™œë™ì§€</h4>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">ë°œí‘œ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ê¸°ëŠ¥ì´ í¬í•¨ëœ ë°œí‘œìš© í™œë™ì§€ í…œí”Œë¦¿</p>
                        <button onclick="useTemplate('presentation')" class="w-full bg-gray-100 text-gray-700 py-2 px-3 rounded-lg hover:bg-gray-200 transition-colors text-sm">
                            í…œí”Œë¦¿ ì‚¬ìš©
                        </button>
                    </div>

                    <!-- ì‹¤í—˜ ë³´ê³ ì„œ í…œí”Œë¦¿ -->
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center mb-3">
                            <span class="text-2xl mr-2">ğŸ§ª</span>
                            <h4 class="font-medium text-gray-800">ì‹¤í—˜ ë³´ê³ ì„œ</h4>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">ì‹¤í—˜ ëª©ì , ë°©ë²•, ê²°ê³¼, ê²°ë¡  ì‘ì„±ì´ í¬í•¨ëœ ì‹¤í—˜ ë³´ê³ ì„œ í…œí”Œë¦¿</p>
                        <button onclick="useTemplate('experiment')" class="w-full bg-gray-100 text-gray-700 py-2 px-3 rounded-lg hover:bg-gray-200 transition-colors text-sm">
                            í…œí”Œë¦¿ ì‚¬ìš©
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ë¡œê·¸ì¸ ì²˜ë¦¬
        document.getElementById('login-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const password = document.getElementById('password').value.trim();
            const errorMessage = document.getElementById('error-message');
            const submitButton = e.target.querySelector('button[type="submit"]');
            
            // ì…ë ¥ê°’ ê²€ì¦
            if (!password) {
                errorMessage.textContent = 'ì•”í˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorMessage.classList.remove('hidden');
                document.getElementById('password').focus();
                return;
            }
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            submitButton.disabled = true;
            submitButton.textContent = 'ì¸ì¦ ì¤‘...';
            submitButton.classList.add('opacity-75', 'cursor-not-allowed');
            errorMessage.classList.add('hidden');
            
            try {
                console.log('ì¸ì¦ ìš”ì²­ ì‹œì‘...');
                
                // ë¡œì»¬ ê°œë°œ í™˜ê²½ ê°ì§€
                const isLocalDev = window.location.hostname === 'localhost' || 
                                 window.location.hostname === '127.0.0.1' ||
                                 window.location.hostname.includes('192.168') ||
                                 window.location.protocol === 'file:';
                
                if (isLocalDev) {
                    console.log('ë¡œì»¬ ê°œë°œ í™˜ê²½ ê°ì§€ë¨, í´ë°± ì¸ì¦ ì‚¬ìš©');
                    // ë¡œì»¬ ê°œë°œìš© í´ë°± ì¸ì¦ (ì„¤ì • íŒŒì¼ì—ì„œ ì•”í˜¸ ê°€ì ¸ì˜¤ê¸°)
                    const localPassword = window.LOCAL_DEV_CONFIG?.ADMIN_PASSWORD || 'teacher2024';
                    if (password === localPassword) {
                        console.log('ë¡œì»¬ ì¸ì¦ ì„±ê³µ');
                        document.getElementById('login-screen').classList.add('hidden');
                        document.getElementById('main-portal').classList.remove('hidden');
                        document.getElementById('main-portal').classList.add('fade-in');
                        
                        // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                        setTimeout(() => {
                            const successToast = document.createElement('div');
                            successToast.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                            successToast.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ! (ë¡œì»¬ ëª¨ë“œ)';
                            document.body.appendChild(successToast);
                            setTimeout(() => successToast.remove(), 2000);
                        }, 100);
                    } else {
                        console.log('ë¡œì»¬ ì¸ì¦ ì‹¤íŒ¨');
                        errorMessage.textContent = 'ì˜ëª»ëœ ì•”í˜¸ì…ë‹ˆë‹¤. ë¡œì»¬ ê°œë°œìš© ì•”í˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.';
                        errorMessage.classList.remove('hidden');
                        document.getElementById('password').value = '';
                        document.getElementById('password').focus();
                    }
                } else {
                    // í”„ë¡œë•ì…˜ í™˜ê²½: Cloudflare Pages Functions ì‚¬ìš©
                    const response = await fetch('/api/auth', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ password })
                    });
                    
                    console.log('ì‘ë‹µ ìƒíƒœ:', response.status);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    const result = await response.json();
                    console.log('ì„œë²„ ì‘ë‹µ:', result);
                    
                    if (result.success) {
                        // ë¡œê·¸ì¸ ì„±ê³µ
                        console.log('ì¸ì¦ ì„±ê³µ');
                        document.getElementById('login-screen').classList.add('hidden');
                        document.getElementById('main-portal').classList.remove('hidden');
                        document.getElementById('main-portal').classList.add('fade-in');
                        
                        // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                        setTimeout(() => {
                            const successToast = document.createElement('div');
                            successToast.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                            successToast.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ!';
                            document.body.appendChild(successToast);
                            setTimeout(() => successToast.remove(), 2000);
                        }, 100);
                    } else {
                        // ë¡œê·¸ì¸ ì‹¤íŒ¨
                        console.log('ì¸ì¦ ì‹¤íŒ¨:', result.error);
                        errorMessage.textContent = result.error || 'ì˜ëª»ëœ ì•”í˜¸ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                        errorMessage.classList.remove('hidden');
                        document.getElementById('password').value = '';
                        document.getElementById('password').focus();
                    }
                }
            } catch (error) {
                console.error('ì¸ì¦ ì˜¤ë¥˜:', error);
                
                // êµ¬ì²´ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ
                let errorText = 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                if (error.message.includes('Failed to fetch')) {
                    errorText = 'ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¡œì»¬ ê°œë°œ í™˜ê²½ì—ì„œëŠ” ì•”í˜¸ "teacher2024"ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.';
                } else if (error.message.includes('HTTP 500')) {
                    errorText = 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                } else if (error.message.includes('HTTP 401')) {
                    errorText = 'ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì•”í˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
                }
                
                errorMessage.textContent = errorText;
                errorMessage.classList.remove('hidden');
            } finally {
                // ë¡œë”© ìƒíƒœ í•´ì œ
                submitButton.disabled = false;
                submitButton.textContent = 'ë¡œê·¸ì¸';
                submitButton.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        });

        // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
        document.getElementById('logout-btn').addEventListener('click', function() {
            document.getElementById('main-portal').classList.add('hidden');
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('password').value = '';
            document.getElementById('error-message').classList.add('hidden');
        });

        // í˜„ì¬ ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('current-time').textContent = timeString;
        }

        // í™œë™ ê´€ë¦¬ ê¸°ëŠ¥ë“¤
        function previewActivity(subject) {
            if (subject === 'physics2') {
                window.open('physics2/activity2/', '_blank');
            } else if (subject === 'science') {
                window.open('science-experiments/', '_blank');
            }
        }

        function editActivity(subject) {
            if (subject === 'physics2') {
                alert('ë¬¼ë¦¬í•™II í™œë™ì§€ í¸ì§‘ ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
            } else if (subject === 'science') {
                alert('ê³¼í•™íƒêµ¬ì‹¤í—˜ í™œë™ì§€ í¸ì§‘ ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
            }
        }

        function createNewActivity() {
            alert('ìƒˆ í™œë™ ìƒì„± ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.\n\nê¸°ëŠ¥:\nâ€¢ í™œë™ ì œëª© ë° ì„¤ëª… ì„¤ì •\nâ€¢ í‰ê°€ ìš”ì†Œ ì„ íƒ\nâ€¢ í™œë™ì§€ í…œí”Œë¦¿ ì ìš©\nâ€¢ ì œì¶œ í˜•íƒœ ì„¤ì •');
        }

        function manageActivities() {
            alert('í™œë™ ëª©ë¡ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.\n\nê¸°ëŠ¥:\nâ€¢ ê¸°ì¡´ í™œë™ ëª©ë¡ ë³´ê¸°\nâ€¢ í™œë™ í™œì„±í™”/ë¹„í™œì„±í™”\nâ€¢ í™œë™ ìˆœì„œ ë³€ê²½\nâ€¢ í™œë™ ì‚­ì œ');
        }

        function useTemplate(templateType) {
            const templates = {
                'basic': 'ê¸°ë³¸ í™œë™ì§€ í…œí”Œë¦¿ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.',
                'presentation': 'ë°œí‘œ í™œë™ì§€ í…œí”Œë¦¿ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.',
                'experiment': 'ì‹¤í—˜ ë³´ê³ ì„œ í…œí”Œë¦¿ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.'
            };
            
            alert(templates[templateType] + '\n\ní…œí”Œë¦¿ ì ìš© ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // í™˜ê²½ë³€ìˆ˜ ìƒíƒœ í™•ì¸ (ê°œë°œìš©)
        async function checkEnvironmentStatus() {
            const debugInfo = document.getElementById('debug-info');
            const envStatus = document.getElementById('env-status');
            
            // ë¡œì»¬ ê°œë°œ í™˜ê²½ ê°ì§€
            const isLocalDev = window.location.hostname === 'localhost' || 
                             window.location.hostname === '127.0.0.1' ||
                             window.location.hostname.includes('192.168') ||
                             window.location.protocol === 'file:';
            
            if (isLocalDev) {
                envStatus.textContent = 'ë¡œì»¬ ëª¨ë“œ (í´ë°± ì¸ì¦)';
                envStatus.className = 'text-blue-500';
                debugInfo.classList.remove('hidden');
                
                // ë¡œì»¬ ê°œë°œ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                const localNotice = document.getElementById('local-dev-notice');
                if (localNotice) {
                    localNotice.classList.remove('hidden');
                }
                return;
            }
            
            try {
                const response = await fetch('/api/auth', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password: 'test' })
                });
                
                if (response.status === 401) {
                    envStatus.textContent = 'ì •ìƒ (í™˜ê²½ë³€ìˆ˜ ì„¤ì •ë¨)';
                    envStatus.className = 'text-green-500';
                } else if (response.status === 500) {
                    envStatus.textContent = 'ì„œë²„ ì˜¤ë¥˜';
                    envStatus.className = 'text-red-500';
                } else {
                    envStatus.textContent = 'ìƒíƒœ ë¶ˆëª…';
                    envStatus.className = 'text-yellow-500';
                }
                
                // ê°œë°œ í™˜ê²½ì—ì„œë§Œ ë””ë²„ê¹… ì •ë³´ í‘œì‹œ
                if (isLocalDev) {
                    debugInfo.classList.remove('hidden');
                }
            } catch (error) {
                console.log('í™˜ê²½ë³€ìˆ˜ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
                envStatus.textContent = 'ì—°ê²° ì‹¤íŒ¨';
                envStatus.className = 'text-red-500';
            }
        }

        // ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘
        setInterval(updateCurrentTime, 1000);
        updateCurrentTime();
        
        // í™˜ê²½ë³€ìˆ˜ ìƒíƒœ í™•ì¸
        checkEnvironmentStatus();

        // ESC í‚¤ë¡œ ë¡œê·¸ì•„ì›ƒ
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && !document.getElementById('main-portal').classList.contains('hidden')) {
                document.getElementById('logout-btn').click();
            }
        });
    </script>
</body>
</html>
